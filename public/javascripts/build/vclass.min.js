function initPr(a){currentPrArray="images_pr"+a,currrentSlideNo="currrent_slide_no"+a,prvSlideNo="prv_slide_no"+a,noOfSlides="no_slides"+a,orgSlideCount="org_slide_cnt"+a,imageRequest="img_request"+a,tmpSlide="tmp_slide"+a,tmpSlideEnd="tmp_slide_end"+a,forceLoad="force_load"+a,whiteboardClicked="whiteboardClicked"+a,shapes="shapes_pr"+a,undoShpArr="undo_shp_arr_pr"+a,pr_fArray="f_array_pr"+a,pr_lArray="l_array_pr"+a,pr_eArray="e_array_pr"+a,pr_rArray="r_array_pr"+a,pr_flArray="fl_array_pr"+a,pr_txtArray="txt_array_pr"+a,storeMessages="storeMsg"+a,undoClickedPr="undo_clicked_pr"+a,shapesLoadedPr="shapes_loaded_pr"+a,vcdata[currrentSlideNo]||(vcdata[currrentSlideNo]=0),vcdata[prvSlideNo]||(vcdata[prvSlideNo]=0),vcdata[currentPrArray]||(vcdata[currentPrArray]=[]),vcdata[noOfSlides]||(vcdata[noOfSlides]=0),vcdata[orgSlideCount]||(vcdata[orgSlideCount]=0),vcdata[imageRequest]||(vcdata[imageRequest]=!1),vcdata[tmpSlide]||(vcdata[tmpSlide]=0),vcdata[tmpSlideEnd]||(vcdata[tmpSlideEnd]=0),vcdata[forceLoad]||(vcdata[forceLoad]=0),vcdata[whiteboardClicked]||(vcdata[whiteboardClicked]=!1),vcdata[shapes]||(vcdata[shapes]=[]),vcdata[pr_txtArray]||(vcdata[pr_txtArray]=[]),vcdata[pr_lArray]||(vcdata[pr_lArray]=[]),vcdata[pr_eArray]||(vcdata[pr_eArray]=[]),vcdata[pr_rArray]||(vcdata[pr_rArray]=[]),vcdata[pr_flArray]||(vcdata[pr_flArray]=[]),vcdata[pr_txtArray]||(vcdata[pr_txtArray]=[]),vcdata[storeMessages]||(vcdata[storeMessages]=!1),vcdata[undoClickedPr]||(vcdata[undoClickedPr]=!1),vcdata[undoShpArr]||(vcdata[undoShpArr]=[]),vcdata[shapesLoadedPr]||(vcdata[shapesLoadedPr]=!1)}function initWb(a){whiteboardClicked="whiteboardClicked"+a,shapes="shapes_wb"+a,wb_lArray="l_array_wb"+a,wb_eArray="e_array_wb"+a,wb_rArray="r_array_wb"+a,wb_flArray="fl_array_wb"+a,wb_txtArray="txt_array_wb"+a,wb_eraseLineArray="erase_fl_array_wb"+a,storeMessages="storeMsg"+a,undoClickedWb="undo_clicked_wb"+a,undoShpArr2="undo_shp_arr_wb"+a,lx="lx_wb"+a,ly="ly_wb"+a,ox="ox_wb"+a,oy="oy_wb"+a,uploadedImgArray="uploaded_images_wb"+a,shapesLoadedWb="shapes_loaded_wb"+a,vcdata[whiteboardClicked]||(vcdata[whiteboardClicked]=!1),vcdata[shapes]||(vcdata[shapes]=[]),vcdata[wb_lArray]||(vcdata[wb_lArray]=[]),vcdata[wb_eArray]||(vcdata[wb_eArray]=[]),vcdata[wb_rArray]||(vcdata[wb_rArray]=[]),vcdata[wb_flArray]||(vcdata[wb_flArray]=[]),vcdata[wb_txtArray]||(vcdata[wb_txtArray]=[]),vcdata[wb_eraseLineArray]||(vcdata[wb_eraseLineArray]=[]),vcdata[storeMessages]||(vcdata[storeMessages]=!1),vcdata[undoClickedWb]||(vcdata[undoClickedWb]=!1),vcdata[lx]||(vcdata[lx]=[]),vcdata[ly]||(vcdata[ly]=[]),vcdata[ox]||(vcdata[ox]=[]),vcdata[oy]||(vcdata[oy]=[]),vcdata[uploadedImgArray]||(vcdata[uploadedImgArray]=[]),vcdata[undoShpArr2]||(vcdata[undoShpArr2]=[]),vcdata[shapesLoadedWb]||(vcdata[shapesLoadedWb]=!1)}function updateSlideCount(a){$(".up-no").empty().append(a)}function updateOriginalSlideCount(a){$("#orgCount").empty().append(a)}function reduceMsg(a,b,c,d){(1===cnt||cnt%d===1)&&a.emit(b,c),cnt++}function FreeLine(a,b,c,d,e,f){var g,h={x:a,y:b},i=function(){return g="M"+h.x+" "+h.y+"l0 0"},j=function(){k.attr("path",i())},k=c.path(i());if(k.attr({stroke:d,"fill-opacity":1,"stroke-width":e}),vcdata[storeMessages]===!0)vcdata[shapes].push({node:k,store:!0});else{var l;l="undefined"==typeof f?shapes+"_"+vcdata[currrentSlideNo]:f,vcdata[shapes].push({node:k,store:!1,prShpID:l})}return{updateStart:function(a,b){return h.x=a,h.y=b,j(),this},updateEnd:function(a,b){return g+="l"+a+" "+b,k.attr("path",g),this},clear:function(){k.remove()},hide:function(){k.hide()},show:function(){k.show()},toFront:function(){k.toFront()},unDrag:function(){k.undrag()}}}function Line(a,b,c,d,e,f,g,h){var i={x:a,y:b},j={x:c,y:d},k=function(){return"M"+i.x+" "+i.y+" L"+j.x+" "+j.y},l=function(){m.attr("path",k())},m=e.path(k());if(m.attr({stroke:f,"fill-opacity":1,"stroke-width":g}),vcdata[storeMessages]===!0)vcdata[shapes].push({node:m,store:!0});else{var n;n="undefined"==typeof h?shapes+"_"+vcdata[currrentSlideNo]:h,vcdata[shapes].push({node:m,store:!1,prShpID:n})}return{updateStart:function(a,b){return i.x=a,i.y=b,l(),this},updateEnd:function(a,b){return j.x=a,j.y=b,l(),this},clear:function(){m.remove()},hide:function(){m.hide()},show:function(){m.show()}}}function Ellipse(a,b,c,d,e,f,g,h){var i={x:a,y:b,w:c,h:d},j={w:c,h:d},k=function(){return j.w},l=function(){return j.h},m=function(){n.attr({rx:k(),ry:l()})},n=e.ellipse(i.x,i.y,k(),l());if(n.attr({stroke:f,"fill-opacity":1,"stroke-width":g}),vcdata[storeMessages]===!0)vcdata[shapes].push({node:n,store:!0});else{var o;o="undefined"==typeof h?shapes+"_"+vcdata[currrentSlideNo]:h,vcdata[shapes].push({node:n,store:!1,prShpID:o})}return{updateStart:function(a,b){return i.x=a,i.y=b,m(),this},updateEnd:function(a,b){var c={x:Math.abs(a-i.x),y:Math.abs(b-i.y)};return j.w=c.x,j.h=c.y,m(),this},clear:function(){n.remove()},hide:function(){n.hide()},show:function(){n.show()}}}function Rect(a,b,c,d,e,f,g,h){var i={x:a,y:b,w:c,h:d},j={w:c,h:d},k=function(){return j.w},l=function(){return j.h},m=function(){n.attr({width:k(),height:l()})},n=e.rect(i.x,i.y,k(),l());if(n.attr({stroke:f,"fill-opacity":1,"stroke-width":g}),vcdata[storeMessages]===!0)vcdata[shapes].push({node:n,store:!0});else{var o;o="undefined"==typeof h?shapes+"_"+vcdata[currrentSlideNo]:h,vcdata[shapes].push({node:n,store:!1,prShpID:o})}return{updateStart:function(a,b){return i.x=a,i.y=b,m(),this},updateEnd:function(a,b){var c={x:Math.abs(a-i.x),y:Math.abs(b-i.y)},d=c.x,e=c.y;return j.h=e,j.w=d,m(),this},clear:function(){n.remove()},hide:function(){n.hide()},show:function(){n.show()}}}function Text(a,b,c,d,e,f){var g={x:a,y:b},h=d.text(g.x,g.y,c);if(h.attr({fill:e,"fill-opacity":1,"font-size":15,"text-anchor":"start"}),vcdata[storeMessages]===!0)vcdata[shapes].push({node:h,store:!0});else{var i;i="undefined"==typeof f?shapes+"_"+vcdata[currrentSlideNo]:f,vcdata[shapes].push({node:h,store:!1,prShpID:i})}return{updateStart:function(a,b){return g.x=a,g.y=b,redraw(),this},clear:function(){h.remove()},hide:function(){h.hide()},show:function(){h.show()}}}function drawText(){$(canvas).unbind(),$(canvas).bind("mousemove",function(a){movePointer(a)}),draw_text=!0;var a,b;$(canvas).mousedown(function(c){void 0===c.offsetX?(a=c.pageX-$(canvas).offset().left,b=c.pageY-$(canvas).offset().top):(a=c.offsetX,b=c.offsetY),a=c.pageX,b=c.pageY-$("#cmd").height()/2,lastX=a,lastY=b,draw_text===!1&&$("#cmd").hide(),draw_text===!0&&($("#cmd").css({left:a,top:b}),$("#cmd").show()),$("#txtinput").focus();window.setInterval(function(){$("#cursor").css("visible"===$("#cursor").css("visibility")?{visibility:"hidden"}:{visibility:"visible"})},500)}),$("#txtinput").keyup(function(a){if(13===a.keyCode){var b=$("#txtinput").val();k=$("#wb1").offset().left,l=$("#wb1").offset().top,rtext=Text(lastX-k,lastY-l,b,paper,colour),socket.emit("draw_text",{txtx:lastX,txty:lastY,tk:k,tl:l,text:b,colour:colour,shpid:shapes+"_"+vcdata[currrentSlideNo],token:accessToken}),draw_text=!1,$("#cmd").hide(),$("#txtinput").val("")}else 27===a.keyCode&&(draw_text=!1,$("#cmd").hide(),$("#txtinput").val(""))}),$("#popupBoxClose").click(function(){$("#cmd").hide()}),$t=$("#wb1"),$("#overlay").css({opacity:.5,top:$t.offset().top,width:$t.outerWidth(),height:$t.outerHeight()})}function drawPath(){cnt=1;var a,b;return $(canvas).unbind(),$(canvas).bind("mousemove",function(a){movePointer(a)}),$("#cmd").hide(),$(canvas).mousedown(function(c){mousedown=!0,void 0===c.offsetX?(a=c.pageX-$(canvas).offset().left,b=c.pageY-$(canvas).offset().top):(a=c.offsetX,b=c.offsetY),$("text").each(function(){$(this).hide()}),fline=FreeLine(a,b,paper,colour,strokeWidth),socket.emit("draw_path",{flb:a,fle:b,colour:colour,strokeWidth:strokeWidth,shpid:shapes+"_"+vcdata[currrentSlideNo],token:accessToken}),lastX=a,lastY=b}),$(canvas).mouseup(function(){mousedown=!1,$(canvas).unbind(),socket.emit("draw_path_update",{arr:vcdata[wb_flArray],shpid:shapes+"_"+vcdata[currrentSlideNo],token:accessToken}),vcdata[wb_flArray].length=0,$("text").each(function(){$(this).show()}),cnt=1,drawPath()}),$(canvas).mousemove(function(a){var b,c;void 0===a.offsetX?(b=a.pageX-$(canvas).offset().left,c=a.pageY-$(canvas).offset().top):(b=a.offsetX,c=a.offsetY),mousedown&&(fline.updateEnd(b-lastX,c-lastY),$("text").each(function(){$(this).hide()}),vcdata[wb_flArray].push({flx:b-lastX,fly:c-lastY}),lastX=b,lastY=c)}),fline}function drawLine(){cnt=1;var a,b;$(canvas).unbind(),$(canvas).bind("mousemove",function(a){movePointer(a)}),$("#cmd").hide(),$(canvas).mousedown(function(c){mousedown=!0,void 0===c.offsetX?(a=c.pageX-$(canvas).offset().left,b=c.pageY-$(canvas).offset().top):(a=c.offsetX,b=c.offsetY),line=Line(a,b,a,b,paper,colour,strokeWidth),socket.emit("draw_line",{lb:a,le:b,colour:colour,strokeWidth:strokeWidth,shpid:shapes+"_"+vcdata[currrentSlideNo],token:accessToken}),$("text").each(function(){$(this).hide()})}),$(canvas).mouseup(function(){mousedown=!1,$(canvas).unbind(),$("text").each(function(){$(this).show()}),cnt=1,drawLine()}),$(canvas).mousemove(function(a){var b,c;void 0===a.offsetX?(b=a.pageX-$(canvas).offset().left,c=a.pageY-$(canvas).offset().top):(b=a.offsetX,c=a.offsetY),mousedown&&(line.updateEnd(b,c),$("text").each(function(){$(this).hide()}),reduceMsg(socket,"draw_line_update",{lx:b,ly:c,shpid:shapes+"_"+vcdata[currrentSlideNo],token:accessToken},sendMsgRatio))})}function drawEllipse(){cnt=1;var a,b;$(canvas).unbind(),$(canvas).bind("mousemove",function(a){movePointer(a)}),$("#cmd").hide(),$(canvas).mousedown(function(c){mousedown=!0,void 0===c.offsetX?(a=c.pageX-$(canvas).offset().left,b=c.pageY-$(canvas).offset().top):(a=c.offsetX,b=c.offsetY),ellipse=Ellipse(a,b,0,0,paper,colour,strokeWidth),socket.emit("draw_ellipse",{cb:a,ce:b,colour:colour,strokeWidth:strokeWidth,shpid:shapes+"_"+vcdata[currrentSlideNo],token:accessToken})}),$(canvas).mouseup(function(){mousedown=!1,$(canvas).unbind(),$("text").each(function(){$(this).show()}),cnt=1,drawEllipse()}),$(canvas).mousemove(function(a){var b,c;void 0===a.offsetX?(b=a.pageX-$(canvas).offset().left,c=a.pageY-$(canvas).offset().top):(b=a.offsetX,c=a.offsetY),mousedown&&($("text").each(function(){$(this).hide()}),ellipse.updateEnd(b,c),reduceMsg(socket,"draw_ellipse_update",{cx:b,cy:c,shpid:shapes+"_"+vcdata[currrentSlideNo],token:accessToken},sendMsgRatio))})}function drawRect(){cnt=1,$(canvas).unbind(),$(canvas).bind("mousemove",function(a){movePointer(a)}),$("#cmd").hide(),$(canvas).mousedown(function(a){var b,c;void 0===a.offsetX?(b=a.pageX-$(canvas).offset().left,c=a.pageY-$(canvas).offset().top):(b=a.offsetX,c=a.offsetY),mousedown=!0,rect=Rect(b,c,0,0,paper,colour,strokeWidth),socket.emit("draw_rect",{rb:b,re:c,colour:colour,strokeWidth:strokeWidth,shpid:shapes+"_"+vcdata[currrentSlideNo],token:accessToken})}),$(canvas).mouseup(function(){mousedown=!1,$(canvas).unbind(),$("text").each(function(){$(this).show()}),cnt=1,drawRect()}),$(canvas).mousemove(function(a){var b,c;void 0===a.offsetX?(b=a.pageX-$(canvas).offset().left,c=a.pageY-$(canvas).offset().top):(b=a.offsetX,c=a.offsetY),mousedown&&($("text").each(function(){$(this).hide()}),rect.updateEnd(b,c),reduceMsg(socket,"draw_rect_update",{rx:b,ry:c,shpid:shapes+"_"+vcdata[currrentSlideNo],token:accessToken},sendMsgRatio))})}function permenentlyDeleteShapes(){Array.prototype.map.call(vcdata[shapes],function(a){a.node.remove()})}function removeEraseData(){"undefined"!=typeof vcdata[restoreEraseDataArr]&&null!==vcdata[restoreEraseDataArr]&&vcdata[whiteboardClicked]===!0&&(vcdata[restoreEraseDataArr].length=0)}function clearPaper(){showHidePrDrawings(90001),vcdata[whiteboardClicked]===!0&&(removeUploadedImages(),permenentlyDeleteShapes(),removeEraseData()),"undefined"!=typeof vcdata[restoreWbDataArr]&&null!==vcdata[restoreWbDataArr]&&vcdata[whiteboardClicked]===!0&&(vcdata[restoreWbDataArr].length=0),"undefined"!=typeof vcdata[restorePrDataArr]&&null!==vcdata[restorePrDataArr]&&vcdata[whiteboardClicked]===!1&&(vcdata[restorePrDataArr].length=0),socket.emit("clear_paper",{clr:!0,wbclicked:vcdata[whiteboardClicked],slideno:vcdata[currrentSlideNo],uploadedImgArray:uploadedImgArray,token:accessToken})}function erase(){if($(canvas).unbind(),vcdata[whiteboardClicked]===!0){cnt=1;var a,b;$(canvas).bind("mousemove",function(a){movePointer(a)}),$("#cmd").hide(),$(canvas).mousedown(function(c){mousedown=!0,void 0===c.offsetX?(a=c.pageX-$(canvas).offset().left,b=c.pageY-$(canvas).offset().top):(a=c.offsetX,b=c.offsetY),$("text").each(function(){$(this).hide()}),erase_fline=FreeLine(a,b,paper,eraserColor,6),socket.emit("erase_line",{eflb:a,efle:b,colour:eraserColor,strokeWidth:6,whiteboardClickedStatus:vcdata[whiteboardClicked],token:accessToken}),lastX=a,lastY=b}),$(canvas).mouseup(function(){mousedown=!1,$(canvas).unbind(),socket.emit("erase_line_update",{earr:vcdata[wb_eraseLineArray],token:accessToken}),vcdata[wb_eraseLineArray]=[],$("text").each(function(){$(this).show()}),cnt=1,erase()}),$(canvas).mousemove(function(a){var b,c;void 0===a.offsetX?(b=a.pageX-$(canvas).offset().left,c=a.pageY-$(canvas).offset().top):(b=a.offsetX,c=a.offsetY),mousedown&&(erase_fline.updateEnd(b-lastX,c-lastY),$("text").each(function(){$(this).hide()}),vcdata[wb_eraseLineArray].push({eflx:b-lastX,efly:c-lastY}),lastX=b,lastY=c)})}}function fullScreen(){function a(a){sendMessage({scope:"photo",name:"enter",id:a.id})}function b(){sendMessage({scope:"photo",name:"exit"})}function c(a){sendMessage({scope:"photo",name:"error",reason:a,id:this.id})}var d=document.getElementById("wb1");BigScreen.toggle(d,a,b,c)}function loadImages(){for(j=0;MIN_SLIDE_COUNT>j;j++)fetchImages(j,currentPrId),vcdata[noOfSlides]=j+1,tmp_slide_std=j+1;vcdata[currentPrArray][0].show(),updateSlideCount(1),function a(){if(vcdata[noOfSlides]<vcdata[orgSlideCount]){if(vcdata[orgSlideCount]-1<vcdata[noOfSlides])return clearTimeout(timer),vcdata[imageRequest]=!1,void(vcdata[imageRequestStudent]=!1);vcdata[imageRequest]===!0&&vcdata[imageRequestStudent]===!0&&(fetchImages(vcdata[noOfSlides],currentPrId),timer=setTimeout(a,TIME_DELAY),vcdata[noOfSlides]++,tmp_slide_std=vcdata[noOfSlides])}}()}function loadFrontImages(a,b){!function c(){if(b>a-1){if(a>b)return void clearTimeout(timer1);fetchImages(a,currentPrId),timer1=setTimeout(c,TIME_DELAY),a++}}()}function showHidePrDrawings(a){var b;b=10001===a?shapes+"_0":50001===a?shapes+"_"+(vcdata[orgSlideCount]-1):90001===a?shapes+"_"+vcdata[currrentSlideNo]:shapes+"_"+(vcdata[currrentSlideNo]+a),vcdata[shapes]&&Array.prototype.map.call(vcdata[shapes],function(c){b===c.prShpID?(c.node.show(),c.node.toFront()):c.node.hide(),90001===a&&b===c.prShpID&&c.node.remove()})}function removeUploadedImages(){vcdata[whiteboardClicked]===!0&&"undefined"!=typeof vcdata[uploadedImgArray]&&Array.prototype.map.call(vcdata[uploadedImgArray],function(a){null!==a&&"undefined"!=typeof a&&a.remove()})}function disableSlideControls(a){a===!0?($("#frst").attr("disabled","disabled"),$("#lst").attr("disabled","disabled"),$("#fwd").attr("disabled","disabled"),$("#prv").attr("disabled","disabled")):a===!1&&($("#frst").removeAttr("disabled"),$("#lst").removeAttr("disabled"),$("#fwd").removeAttr("disabled"),$("#prv").removeAttr("disabled"))}function getInnerBound(a,b){for(var c=0,d=shapes+"_"+b,e=0;a.length>0&&e<a.length&&d!==a[e].prShpID;)c++,e++;return c}function getShapeCount(a,b){for(var c=0,d=shapes+"_"+b,e=0;a.length>0&&e<a.length;)d===a[e].prShpID&&c++,e++;return c}function getShapeCountWb(a){for(var b=0,c=0;a.length>0&&c<a.length;)b++,c++;return b}function sortShapes(a){for(var b=0;b<a.length;b++)for(var c=b;c<a.length;c++)if(parseInt(a[b].prShpID.slice(-1))>parseInt(a[c].prShpID.slice(-1))){var d=a[b];a[b]=a[c],a[c]=d}}function undo(){if(vcdata[whiteboardClicked]===!0){var a=getShapeCountWb(vcdata[shapes]);vcdata[shapes][a-1]&&(vcdata[shapes][a-1].node.hide(),vcdata[undoShpArr2].push(vcdata[shapes][a-1]),vcdata[shapes].splice(a-1,1)),socket.emit("undo_drawing",{undo:!0,wbclicked:vcdata[whiteboardClicked]})}else{if(vcdata[shapes]){sortShapes(vcdata[shapes]);var b=getInnerBound(vcdata[shapes],vcdata[currrentSlideNo]),c=getShapeCount(vcdata[shapes],vcdata[currrentSlideNo]);vcdata[shapes][c+b-1]&&(vcdata[shapes][c+b-1].node.hide(),vcdata[undoShpArr].push(vcdata[shapes][c+b-1]),vcdata[shapes].splice(c+b-1,1))}socket.emit("undo_drawing",{undo:!0,wbclicked:vcdata[whiteboardClicked],slideno:vcdata[currrentSlideNo]})}}function redo(){if(vcdata[whiteboardClicked]===!0){var a=getShapeCountWb(vcdata[undoShpArr2]);vcdata[undoShpArr2]&&(vcdata[undoShpArr2][a-1].node.show(),vcdata[shapes].push(vcdata[undoShpArr2][a-1]),vcdata[undoShpArr2].splice(a-1,1)),socket.emit("redo_drawing",{undo:!0,wbclicked:vcdata[whiteboardClicked]})}else{{vcdata[undoShpArr].length}sortShapes(vcdata[undoShpArr]);var b=getInnerBound(vcdata[undoShpArr],vcdata[currrentSlideNo]),c=getShapeCount(vcdata[undoShpArr],vcdata[currrentSlideNo]);vcdata[undoShpArr][b]&&(vcdata[undoShpArr][c+b-1].node.show(),vcdata[shapes].push(vcdata[undoShpArr][c+b-1]),vcdata[undoShpArr].splice(c+b-1,1)),socket.emit("redo_drawing",{undo:!0,wbclicked:vcdata[whiteboardClicked],slideno:vcdata[currrentSlideNo]})}}function requestImageRange(a){vcdata[forceLoad]<vcdata[tmpSlideEnd]&&a>vcdata[forceLoad]&&a<vcdata[orgSlideCount]&&vcdata[forceLoad]<=vcdata[orgSlideCount]-3&&(vcdata[forceLoad]=a,function b(){fetchImages(vcdata[forceLoad],currentPrId),timer2=setTimeout(b,TIME_DELAY),vcdata[forceLoad]>a+3&&(clearTimeout(timer2),vcdata[forceLoad]=a+3),vcdata[forceLoad]++}())}function requestOtherImages(a,b){!function c(){if(b>a-1){if(a>b)return void clearTimeout(timer4);fetchImages(b,currentPrId),timer4=setTimeout(c,TIME_DELAY),b--,vcdata[tmpSlideEnd]=b}}()}function gotoNext(){vcdata[currrentSlideNo]==vcdata[orgSlideCount]-2&&$("#fwd").attr("disabled","disabled"),clearTimeout(timer7),vcdata[storeMessages]=!1,showHidePrDrawings(1),$("#frst").removeAttr("disabled"),$("#prv").removeAttr("disabled"),isLastClicked===!0&&vcdata[currentPrArray][0].hide(),next=vcdata[currrentSlideNo]+1,prv=vcdata[currrentSlideNo],next<vcdata[orgSlideCount]&&("undefined"==typeof vcdata[currentPrArray][next]&&(clearTimeout(timer6),clearTimeout(timer7),fetchImages(next,currentPrId)),vcdata[currentPrArray][prv].hide(),vcdata[currentPrArray][next].show(),socket.emit("gotonext",{next_page:next,prv_page:prv,currentPrId:currentPrId,token:accessToken}),updateSlideCount(next+1),vcdata[currrentSlideNo]++)}function gotoPrv(){vcdata[storeMessages]=!1,showHidePrDrawings(-1),vcdata[currrentSlideNo]>=1&&(vcdata[currrentSlideNo]<=1&&($("#prv").attr("disabled","disabled"),$("#frst").attr("disabled","disabled")),$("#lst").removeAttr("disabled"),$("#fwd").removeAttr("disabled"),next=vcdata[currrentSlideNo]-1,prv=vcdata[currrentSlideNo],"undefined"==typeof vcdata[currentPrArray][next]?(clearTimeout(timer6),clearTimeout(timer7),fetchImages(next,currentPrId),vcdata[currentPrArray][prv].hide(),vcdata[currentPrArray][next].show(),socket.emit("gotoprv",{next_page:next,prv_page:prv,currentPrId:currentPrId,token:accessToken})):(vcdata[currentPrArray][next].show(),vcdata[currentPrArray][prv].hide(),socket.emit("gotoprv",{next_page:next,prv_page:prv,currentPrId:currentPrId,token:accessToken})),updateSlideCount(next+1),vcdata[currrentSlideNo]--)}function gotoFirst(){clearTimeout(timer2),$("#fwd").removeAttr("disabled"),isLastClicked===!0&&(clearTimeout(timer4),"undefined"===vcdata[tmpSlideEnd]&&(vcdata[tmpSlideEnd]=vcdata[tmpSlide]),vcdata[currentPrArray][0].hide()),vcdata[storeMessages]=!1,showHidePrDrawings(10001),$("#lst").removeAttr("disabled"),$("#frst").attr("disabled","disabled"),$("#prv").attr("disabled","disabled"),next=0,prv=vcdata[currrentSlideNo],vcdata[currentPrArray][next]||fetchImages(next,currentPrId),vcdata[currentPrArray][prv].hide(),vcdata[currentPrArray][next].show(),socket.emit("gotofrst",{next_page:next,prv_page:prv,currentPrId:currentPrId,token:accessToken}),vcdata[currrentSlideNo]=0,updateSlideCount(next+1)}function gotoLast(){clearTimeout(timer6),$("#fwd").attr("disabled","disabled"),vcdata[storeMessages]=!1,isLastClicked===!1?(isLastClicked=!0,vcdata[tmpSlide]=vcdata[noOfSlides]):isLastClicked=!1,$("#lst").attr("disabled","disabled"),$("#frst").removeAttr("disabled"),$("#prv").removeAttr("disabled"),showHidePrDrawings(50001),next=vcdata[orgSlideCount]-1,prv=vcdata[currrentSlideNo],vcdata[imageRequestStudent]===!0&&("undefined"!=typeof vcdata[tmpSlideEnd]?(requestOtherImages(vcdata[noOfSlides],vcdata[tmpSlideEnd]-1),vcdata[imageRequestStudent]=!1):(requestOtherImages(vcdata[noOfSlides],next),vcdata[imageRequestStudent]=!1)),"undefined"==typeof vcdata[currentPrArray][next]&&fetchImages(next,currentPrId),vcdata[currentPrArray][prv].hide(),vcdata[currentPrArray][next].show(),socket.emit("gotolst",{next_page:next,prv_page:prv,currentPrId:currentPrId,token:accessToken}),vcdata[noOfSlides]=vcdata[orgSlideCount],vcdata[currrentSlideNo]=vcdata[orgSlideCount]-1,updateSlideCount(next+1)}function fetchImages(a,b){a>=0&&(vcdata[currentPrArray][a]=paper.image(slide_dir+b+"_"+a+".gif?"+(new Date).getTime(),0,0,WHITEBOARD_WIDTH,WHITEBOARD_HEIGHT),vcdata[currentPrArray][a].node.id=b+"_"+a,vcdata[currentPrArray][a].node.preserveAspectRatio.baseVal.align=6,vcdata[currentPrArray][a].hide())}function remoteShowHideUploadedimgs(a){var b;b=shapes+"_"+vcdata[currrentSlideNo],Array.prototype.map.call(vcdata[shapes],function(c){90001===a?b===c.prShpID&&c.node.remove():b===c.prShpID?c.node.show():c.node.hide()})}function restoreEraseData(a,b){wb_eraseLineArray="erase_fl_array_wb"+b,vcdata[wb_eraseLineArray]||(vcdata[wb_eraseLineArray]=[]),null!==a&&Array.prototype.map.call(a,function(a){wb_eraseLineArray===a._eflarray&&wb_eraseLineArray===a._eflarray&&(a._eflb||a._earr)&&vcdata[wb_eraseLineArray].push(a)}),0!==vcdata[wb_eraseLineArray].length&&Array.prototype.map.call(vcdata[wb_eraseLineArray],function(a){"undefined"!=typeof a._eflb&&(erase_line=FreeLine(a._eflb,a._efle,paper,a._colour,a._strokeWidth)),"undefined"==typeof a._eflb&&Array.prototype.map.call(a._earr,function(a){erase_line.updateEnd(a.eflx,a.efly)})}),vcdata[wb_eraseLineArray].length=0}function restoreShapesWb(a,b){wb_flArray="fl_array_wb"+b,wb_lArray="l_array_wb"+b,wb_eArray="e_array_wb"+b,wb_rArray="r_array_wb"+b,wb_txtArray="txt_array_wb"+b,shapes="shapes_wb"+b,undoShpArr2="undo_shp_arr_wb"+b,vcdata[wb_flArray]||(vcdata[wb_flArray]=[]),vcdata[wb_lArray]||(vcdata[wb_lArray]=[]),vcdata[wb_eArray]||(vcdata[wb_eArray]=[]),vcdata[wb_rArray]||(vcdata[wb_rArray]=[]),vcdata[wb_txtArray]||(vcdata[wb_txtArray]=[]),vcdata[shapes]||(vcdata[shapes]=[]),vcdata[undoShpArr2]||(vcdata[undoShpArr2]=[]),null!==a&&Array.prototype.map.call(a,function(a){wb_lArray===a._larray?(a._lb||a._lx)&&vcdata[wb_lArray].push(a):wb_flArray===a._flarray?(a._flb||a._arr)&&vcdata[wb_flArray].push(a):wb_eArray===a._earray?(a._cb||a._cx)&&vcdata[wb_eArray].push(a):wb_rArray===a._rarray?(a._rb||a._rx)&&vcdata[wb_rArray].push(a):wb_txtArray===a._txtarray&&a._text&&vcdata[wb_txtArray].push(a)}),0!==vcdata[wb_flArray].length&&Array.prototype.map.call(vcdata[wb_flArray],function(a){"undefined"!=typeof a._flb&&(fline=FreeLine(a._flb,a._fle,paper,a._colour,a._strokeWidth)),"undefined"==typeof a._flb&&Array.prototype.map.call(a._arr,function(a){fline.updateEnd(a.flx,a.fly)})}),vcdata[wb_flArray].length=0,0!==vcdata[wb_eArray]&&Array.prototype.map.call(vcdata[wb_eArray],function(a){"undefined"!=typeof a._cb&&(ellipse=Ellipse(a._cb,a._ce,0,0,paper,a._colour,a._strokeWidth)),"undefined"==typeof a._cb&&ellipse.updateEnd(a._cx,a._cy)}),vcdata[wb_eArray].length=0,0!==vcdata[wb_rArray]&&Array.prototype.map.call(vcdata[wb_rArray],function(a){"undefined"!=typeof a._rb&&(rect=Rect(a._rb,a._re,5,5,paper,a._colour,a._strokeWidth)),"undefined"==typeof a._rb&&rect.updateEnd(a._rx,a._ry)}),vcdata[wb_rArray].length=0,0!==vcdata[wb_lArray]&&Array.prototype.map.call(vcdata[wb_lArray],function(a){"undefined"!=typeof a._lb&&(line=Line(a._lb,a._le,a._lb,a._le,paper,a._colour,a._strokeWidth)),"undefined"==typeof a._lb&&line.updateEnd(a._lx,a._ly)}),vcdata[wb_lArray].length=0,0!==vcdata[wb_txtArray]&&Array.prototype.map.call(vcdata[wb_txtArray],function(a){text=Text(a._txtx,a._txty,a._text,paper,a._colour)}),vcdata[wb_txtArray].length=0,vcdata[shapesLoadedWb]=!0}function showHideUploadedimgs(a){"undefined"!=typeof vcdata[uploadedImgArray]&&Array.prototype.map.call(vcdata[uploadedImgArray],function(b){"undefined"!=typeof b&&null!==b&&(a===!0?b.show():b.hide())})}function emptyElementArraysWb(){(null!==vcdata[wb_lArray]||null!==vcdata[wb_flArray]||null!==vcdata[wb_eArray]||null!==vcdata[wb_rArray]||null!==vcdata[wb_txtArray])&&(vcdata[wb_lArray].length=0,vcdata[wb_flArray].length=0,vcdata[wb_eArray].length=0,vcdata[wb_rArray].length=0,vcdata[wb_txtArray].length=0)}function emptyElementArraysPr(){(null!==vcdata[pr_lArray]||null!==vcdata[pr_flArray]||null!==vcdata[pr_eArray]||null!==vcdata[pr_rArray]||null!==vcdata[pr_txtArray])&&(vcdata[pr_lArray].length=0,vcdata[pr_flArray].length=0,vcdata[pr_eArray].length=0,vcdata[pr_rArray].length=0,vcdata[pr_txtArray].length=0)}function switchToPresentation(a){$(canvas).unbind(),$(canvas).bind("mousemove",function(a){movePointer(a)}),showHideUploadedimgs(!1),clearTimeout(timer7),"undefined"!=typeof vcdata[currentPrArray][vcdata[currrentSlideNo]]&&vcdata[currentPrArray][vcdata[currrentSlideNo]].hide();var b=currentPrArray;vcdata[prvSlideNo]=vcdata[currrentSlideNo];var c=shapes,d=whiteboardClicked;vcdata[whiteboardClicked]=!1,initPr(a),currentPrId=a,vcdata[storeMessages]=!1;var e;e=shapes+"_"+vcdata[currrentSlideNo],"undefined"!=typeof vcdata[c]&&"undefined"!=typeof vcdata[shapes]&&(Array.prototype.map.call(vcdata[shapes],function(a){a.store;shapes!==c&&(e===a.prShpID?a.node.show():a.node.hide())}),Array.prototype.map.call(vcdata[c],function(a){a.store;shapes!==c&&a.node.hide()})),null===vcdata[currentPrArray]||0===vcdata[currentPrArray].length?(loadImages(),vcdata[whiteboardClicked]===!0&&vcdata[currentPrArray][0].hide()):vcdata[currentPrArray][vcdata[currrentSlideNo]].show(),null!==vcdata[restorePrDataArr]&&0!==vcdata[restorePrDataArr].length&&vcdata[shapesLoadedPr]===!1&&restoreShapesPr(vcdata[restorePrDataArr],a,vcdata[currrentSlideNo]),vcdata[whiteboardClicked]===!0?($("#wbl").attr("disabled","disabled"),$("#switch").removeAttr("disabled"),disableSlideControls(!0)):($("#wbl").removeAttr("disabled"),$("#switch").attr("disabled","disabled"),disableSlideControls(!1)),socket.emit("move_to_presentation",{currrentSlideNo:currrentSlideNo,currentPrArray:currentPrArray,presentationID:a,whiteboardClicked:whiteboardClicked,prvPrArray:b,prvSlide:vcdata[prvSlideNo],noOfSlides:noOfSlides,orgSlideCount:orgSlideCount,imageRequest:imageRequest,tmpSlide:tmpSlide,tmpSlideEnd:tmpSlideEnd,forceLoad:forceLoad,currrentPrSlideNo:vcdata[currrentSlideNo],whiteboardClickedStatus:!1,prvWhiteboardClickedStatus:vcdata[d],shapes:shapes,prvShapes:c,pr_flArray:pr_flArray,pr_lArray:pr_lArray,pr_eArray:pr_eArray,pr_rArray:pr_rArray,pr_txtArray:pr_txtArray,storeMessages:storeMessages,storeMessagesStatus:vcdata[storeMessages],shapesLoadedPr:shapesLoadedPr,token:accessToken}),vcdata[whiteboardClicked]=!1,updateOriginalSlideCount(vcdata[orgSlideCount]),updateSlideCount(vcdata[currrentSlideNo]+1)}function loadWhiteboard(a){$(canvas).unbind(),$(canvas).bind("mousemove",function(a){movePointer(a)}),showHideUploadedimgs(!1),clearTimeout(timer7),"undefined"!=typeof vcdata[currentPrArray][vcdata[currrentSlideNo]]&&vcdata[currentPrArray][vcdata[currrentSlideNo]].hide();var b=currentPrArray;vcdata[prvSlideNo]=vcdata[currrentSlideNo],vcdata[whiteboardClicked]=!0;var c=shapes;initWb(a),currentWbId=a,"undefined"!=typeof vcdata[c]&&"undefined"!=typeof vcdata[shapes]&&(Array.prototype.map.call(vcdata[shapes],function(a){a.store;shapes!==c&&a.node.show()}),Array.prototype.map.call(vcdata[c],function(a){a.store;shapes!==c&&a.node.hide()})),vcdata[storeMessages]=!0,"undefined"!=typeof vcdata[currentPrArray][vcdata[currrentSlideNo]]&&vcdata[currentPrArray][vcdata[currrentSlideNo]].hide(),null!==vcdata[restoreWbDataArr]&&0!==vcdata[restoreWbDataArr].length&&vcdata[shapesLoadedWb]===!1&&restoreShapesWb(vcdata[restoreWbDataArr],a),null!==vcdata[restoreEraseDataArr]&&restoreEraseData(vcdata[restoreEraseDataArr],a),vcdata[whiteboardClicked]===!0?($("#wbl").attr("disabled","disabled"),$("#switch").removeAttr("disabled"),disableSlideControls(!0)):($("#wbl").removeAttr("disabled"),$("#switch").attr("disabled","disabled"),disableSlideControls(!1)),showHideUploadedimgs(!0),socket.emit("move_to_whiteboard",{whiteboardID:a,whiteboardClicked:whiteboardClicked,whiteboardClickedStatus:!0,prvPrArray:b,prvSlide:vcdata[prvSlideNo],currentPrArray:currentPrArray,currrentSlideNo:currrentSlideNo,shapes:shapes,prvShapes:c,wb_flArray:wb_flArray,wb_lArray:wb_lArray,wb_eArray:wb_eArray,wb_rArray:wb_rArray,wb_txtArray:wb_txtArray,wb_eraseLineArray:wb_eraseLineArray,storeMessages:storeMessages,storeMessagesStatus:vcdata[storeMessages],uploadedImgArray:uploadedImgArray,shapesLoadedWb:shapesLoadedWb,lx:lx,ly:ly,ox:ox,oy:oy,token:accessToken}),vcdata[whiteboardClicked]=!0}function restoreShapesPr(a,b,c){pr_flArray="fl_array_pr"+b,pr_lArray="l_array_pr"+b,pr_eArray="e_array_pr"+b,pr_rArray="r_array_pr"+b,pr_txtArray="txt_array_pr"+b,shapes="shapes_pr"+b,undoShpArr="undo_shp_arr_pr"+b,vcdata[pr_flArray]||(vcdata[pr_flArray]=[]),vcdata[pr_lArray]||(vcdata[pr_lArray]=[]),vcdata[pr_eArray]||(vcdata[pr_eArray]=[]),vcdata[pr_rArray]||(vcdata[pr_rArray]=[]),vcdata[pr_txtArray]||(vcdata[pr_txtArray]=[]),vcdata[shapes]||(vcdata[shapes]=[]),vcdata[undoShpArr]||(vcdata[undoShpArr]=[]);var d=shapes+"_"+c;null!==a&&Array.prototype.map.call(a,function(a){pr_lArray===a._larraytmp?(a._lb||a._lx)&&vcdata[pr_lArray].push(a):pr_flArray===a._flarraytmp?(a._flb||a._arr)&&vcdata[pr_flArray].push(a):pr_eArray===a._earraytmp?(a._cb||a._cx)&&vcdata[pr_eArray].push(a):pr_rArray===a._rarraytmp?(a._rb||a._rx)&&vcdata[pr_rArray].push(a):pr_txtArray===a._txtarraytmp&&a._text&&vcdata[pr_txtArray].push(a)}),"undefined"!=typeof vcdata[pr_flArray]&&0!==vcdata[pr_flArray].length&&Array.prototype.map.call(vcdata[pr_flArray],function(a){"undefined"!=typeof a._flb&&(fline=FreeLine(a._flb,a._fle,paper,a._colour,a._strokeWidth,a._shpid),d===a._shpid?fline.show():fline.hide()),"undefined"==typeof a._flb&&Array.prototype.map.call(a._arr,function(b){fline.updateEnd(b.flx,b.fly),d===a._shpid?fline.show():fline.hide()})}),vcdata[pr_flArray]&&(vcdata[pr_flArray].length=0),"undefined"!=typeof vcdata[pr_eArray]&&0!==vcdata[pr_eArray]&&Array.prototype.map.call(vcdata[pr_eArray],function(a){"undefined"!=typeof a._cb&&(ellipse=Ellipse(a._cb,a._ce,0,0,paper,a._colour,a._strokeWidth,a._shpid),d===a._shpid?ellipse.show():ellipse.hide()),"undefined"==typeof a._cb&&(ellipse.updateEnd(a._cx,a._cy),d===a._shpid?ellipse.show():ellipse.hide())}),vcdata[pr_eArray]&&(vcdata[pr_eArray].length=0),"undefined"!=typeof vcdata[pr_rArray]&&Array.prototype.map.call(vcdata[pr_rArray],function(a){"undefined"!=typeof a._rb&&(rect=Rect(a._rb,a._re,5,5,paper,a._colour,a._strokeWidth,a._shpid),d===a._shpid?rect.show():rect.hide()),"undefined"==typeof a._rb&&(rect.updateEnd(a._rx,a._ry),d===a._shpid?rect.show():rect.hide())}),vcdata[pr_rArray]&&(vcdata[pr_rArray].length=0),"undefined"!=typeof vcdata[pr_lArray]&&0!==vcdata[pr_lArray]&&Array.prototype.map.call(vcdata[pr_lArray],function(a){"undefined"!=typeof a._lb&&(line=Line(a._lb,a._le,a._lb,a._le,paper,a._colour,a._strokeWidth,a._shpid),d===a._shpid?line.show():line.hide()),"undefined"==typeof a._lb&&(line.updateEnd(a._lx,a._ly),d===a._shpid?line.show():line.hide())}),vcdata[pr_lArray]&&(vcdata[pr_lArray].length=0),"undefined"!=typeof vcdata[pr_txtArray]&&0!==vcdata[pr_txtArray].length&&(text=Text(vcdata[pr_txtArray][0]._txtx,vcdata[pr_txtArray][0]._txty,vcdata[pr_txtArray][0]._text,paper,vcdata[pr_txtArray][0]._colour,vcdata[pr_txtArray][0]._shpid),d===vcdata[pr_txtArray][0]._shpid?text.show():text.hide()),vcdata[pr_txtArray]&&(vcdata[pr_txtArray].length=0),vcdata[shapesLoadedPr]=!0
}function loadUploadedImage(a,b){imgNo=b,imgUrl=uploads_dir+"uploaded_"+a+"_"+imgNo+".png";var c=new Image;c.src=imgUrl,c.onload=function(){var b=c.width,d=c.height;"undefined"!=typeof vcdata[uploadedImgArray]&&("undefined"==typeof vcdata[uploadedImgArray][imgNo]&&(vcdata[uploadedImgArray][imgNo]=paper.image(imgUrl,0,0,b,d),no=10>imgNo?"0"+imgNo:imgNo,vcdata[uploadedImgArray][imgNo].node.id="uploaded_"+a+"_"+no),vcdata[whiteboardClicked]===!0?vcdata[uploadedImgArray][imgNo].draggable():Array.prototype.map.call(vcdata[uploadedImgArray],function(a){"undefined"!=typeof a&&a.hide()})),WbNo=a,socket.emit("load_uploaded_image",{whiteboardClicked:!0,currentWbNo:WbNo.toString(),currentWbId:a,imgNo:imgNo,uploadedImgArray:uploadedImgArray,token:accessToken,width:b,height:d})}}function mvCur(a,b){cur.attr({cx:a,cy:b})}function movePointer(a){var b,c;void 0===a.offsetX?(b=a.pageX-$(canvas).offset().left,c=a.pageY-$(canvas).offset().top):(b=a.offsetX,c=a.offsetY),mvCur(b,c),curPositionArr.push({mx:b,my:c}),lastTimeMouseMoved=(new Date).getTime();setTimeout(function(){var a=(new Date).getTime();a-lastTimeMouseMoved>1e3&&(curPositionArr.push({mx:b,my:c}),socket.emit("mouse_position",curPositionArr),curPositionArr.length=0)},1e3)}function raiseHand(){socket.emit("hand_raise",{uid:"duminda",token:"eee458fc0e164cb5af7978eb5c5af0c1"})}function giveWhiteboardAccess(){accessToWhiteboard===!0?socket.emit("allow_whiteboard",{allow:!0,uid:"duminda",token:"eee458fc0e164cb5af7978eb5c5af0c1"}):socket.emit("allow_whiteboard",{allow:!1})}function getWhiteboardAccess(){socket.emit("allow_whiteboard",{allow:!1,uid:"kavi",whiteboardClicked:vcdata[whiteboardClicked],token:"1435f0549f2c4b4a95f36e5e82f3bd46"})}var PORT=843,SERVER_IP=window.location.hostname,socket=io.connect("https://"+SERVER_IP,{secure:!0}),slide_dir="https://"+SERVER_IP+":"+PORT+"/images/slides/",uploads_dir="https://"+SERVER_IP+":"+PORT+"/images/uploads/",VClassData=function(){this.shapes_wb1=[],this.undo_shapes_wb1=[],this.shapes_pr1=[],this.l_array_wb1=[],this.r_array_wb1=[],this.e_array_wb1=[],this.fl_array_wb1=[],this.txt_array_wb1=[],this.erase_fl_array_wb1=[],this.l_array_pr1=[],this.r_array_pr1=[],this.e_array_pr1=[],this.fl_array_pr1=[],this.txt_array_pr1=[],this.storeMsg1=!1,this.client_reconnect1=!1,this.whiteboardClicked1=!1,this.tmp_slide1=0,this.tmp_slide_end1=0,this.force_load1=0,this.images_pr1=[],this.no_slides1=0,this.currrent_slide_no1=0,this.img_request1=!0,this.img_request_student1=!0,this.restore_data_arr_wb1=[],this.restore_data_arr_pr1=[],this.restore_erase_data_wb1=[],this.uploaded_images_wb1=[],this.undo_clicked_wb1=!1,this.undo_clicked_pr1=!1,this.scount_wb1,this.lx_wb1=[],this.ly_wb1=[],this.ox_wb1=[],this.oy_wb1=[],this.slide_shp_cnt1=0,this.undo_shp_arr_pr1=[],this.undo_shp_arr_wb1=[],this.prv_slide_no1=0,this.shapes_loaded_pr1=!1,this.shapes_loaded_wb1=!1,this.org_slide_cnt1=$("#sldcnt1").text(),this.org_slide_cnt2=$("#sldcnt2").text(),this.org_slide_cnt3=$("#sldcnt3").text(),this.org_slide_cnt4=$("#sldcnt4").text()},shapes="shapes_pr1",undoShpArr="undo_shp_arr_pr1",undoShpArr2="undo_shp_arr_wb1",wb_lArray="l_array_wb1",wb_eArray="e_array_wb1",wb_rArray="r_array_wb1",wb_flArray="fl_array_wb1",wb_eraseLineArray="erase_fl_array_wb1",wb_txtArray="txt_array_wb1",pr_lArray="l_array_pr1",pr_eArray="e_array_pr1",pr_rArray="r_array_pr1",pr_flArray="fl_array_pr1",pr_txtArray="txt_array_pr1",storeMessages="storeMsg1",clientReconnect="client_reconnect1",whiteboardClicked="whiteboardClicked1",tmpSlide="tmp_slide1",tmpSlideEnd="tmp_slide_end1",forceLoad="force_load1",currentPrArray="images_pr1",uploadedImgArray="uploaded_images_wb1",currrentSlideNo="currrent_slide_no1",prvSlideNo="prv_slide_no1",noOfSlides="no_slides1",orgSlideCount="org_slide_cnt1",imageRequest="img_request1",imageRequestStudent="img_request_student1",restoreWbDataArr="restore_data_arr_wb1",restorePrDataArr="restore_data_arr_pr1",restoreEraseDataArr="restore_erase_data_wb1",undoClickedWb="undo_clicked_wb1",undoClickedPr="undo_clicked_pr1",lx="lx_wb1",ly="ly_wb1",ox="ox_wb1",oy="oy_wb1",shapesLoadedPr="shapes_loaded_pr1",shapesLoadedWb="shapes_loaded_wb1",vcdata=new VClassData,noPresentation=!1,line,fline,ellipse,rect,text,rtext,erase_fline,sendMsgRatio=3,timer,timer1,timer2,timer3,timer4,timer5,timer6,timer7,WHITEBOARD_WIDTH=720,WHITEBOARD_HEIGHT=540,TIME_DELAY=1e3,MIN_SLIDE_COUNT=5,MAX_UPLOADED_IMAGES=20,canvas=document.getElementById("wb1"),paper=new Raphael(canvas,WHITEBOARD_WIDTH,WHITEBOARD_HEIGHT),mousedown=!1,lastX,lastY,pathString,cntt,flag_pr,flag_wb,draw_text,isLastClicked=!1,studInLastSlide=!1,student_access=!1,imgNo=1,strokeWidth=1,eraserColor="#1b831f",accessToken="1435f0549f2c4b4a95f36e5e82f3bd46",slidesUploaded="yes",currentPrId="1",currentWbId="1",colour="black",curPositionArr=[],cur=paper.circle(0,0,3);cur.attr("fill","red"),-1!==navigator.userAgent.indexOf("Firefox")&&paper.renderfix(),$("#txtinput").keyup(function(){$("#cmd span").text($(this).val())}),$("#txtinput").blur(function(){clearInterval(cursor),$("#cursor").css({visibility:"visible"})}),$("#canvascolours [data-colour]").each(function(){var a=$(this),b=a.data("colour");a.css("background-color",b),a.click(function(){colour=b})}),$(document).bind("dragstart",function(){return!1}),"yes"===slidesUploaded&&loadImages(),$(canvas).mousemove(function(a){movePointer(a)}),socket.on("mouse_position_update",function(a){function b(){a[c]&&(cur.animate({cx:a[c].mx,cy:a[c].my},1,"linear",b),c++)}var c=0;b()}),$("body").on("change","#thickness",function(){strokeWidth=$("option:selected").text()}),Raphael.el.draggable=function(){var a=this,b=function(b,c){wbNo=currentWbId,vcdata[lx][imgNo]=b+vcdata[ox][imgNo],vcdata[ly][imgNo]=c+vcdata[oy][imgNo],a.transform("t"+vcdata[lx][imgNo]+","+vcdata[ly][imgNo])},c=function(){$(canvas).unbind(),$(canvas).bind("mousemove",function(a){movePointer(a)});var a=$(this)[0].node.id.slice(-2);if(10>a&&(a=a.slice(-1)),imgNo=a,wbNo=currentWbId,vcdata[ox][imgNo]||(vcdata[ox][imgNo]=0),vcdata[oy][imgNo]||(vcdata[oy][imgNo]=0),0===vcdata[lx].length)for(var b=0;MAX_UPLOADED_IMAGES>b;b++)vcdata[lx][b]=0;if(0===vcdata[ly].length)for(var c=0;MAX_UPLOADED_IMAGES>c;c++)vcdata[ly][c]=0;if(0===vcdata[ox].length)for(var d=0;MAX_UPLOADED_IMAGES>d;d++)vcdata[ox][d]=0;if(0===vcdata[oy].length)for(var e=0;MAX_UPLOADED_IMAGES>e;e++)vcdata[oy][e]=0},d=function(){vcdata[ox][imgNo]=vcdata[lx][imgNo],vcdata[oy][imgNo]=vcdata[ly][imgNo],socket.emit("drag_uploaded_image",{_ox:vcdata[ox][imgNo],_oy:vcdata[oy][imgNo],lx:lx,ly:ly,ox:ox,oy:oy,uploadedImgArray:uploadedImgArray,imgNo:imgNo,wbNo:wbNo.toString(),token:accessToken})};this.drag(b,c,d)};var uploader=document.getElementById("uploader");upclick({element:uploader,action:"/upload",onstart:function(){},oncomplete:function(a){data=JSON.parse(a),loadUploadedImage(currentWbId,data.count)}}),socket.on("drag_uploaded_image",function(a){vcdata[a.uploadedImgArray][parseInt(a.imgNo)].transform("t"+a._ox+","+a._oy)}),socket.on("load_uploaded_image",function(a){imgUrl=uploads_dir+"uploaded_"+a.currentWbId+"_"+a.imgNo+".png";var b=new Image;b.src=imgUrl,b.onload=function(){var c=b.width,d=b.height;"undefined"==typeof vcdata[a.uploadedImgArray][a.imgNo]&&(vcdata[a.uploadedImgArray][a.imgNo]=paper.image(imgUrl,0,0,c,d),no=a.imgNo<10?"0"+a.imgNo:a.imgNo,vcdata[a.uploadedImgArray][a.imgNo].node.id="uploaded_"+a.currentWbId+"_"+no),a.whiteboardClicked===!0?vcdata[a.uploadedImgArray][a.imgNo].draggable():Array.prototype.map.call(vcdata[a.uploadedImgArray],function(a){"undefined"!=typeof a&&a.hide()})}}),socket.on("move_to_whiteboard",function(a){showHideUploadedimgs(!1),clearTimeout(timer7),"undefined"!=typeof vcdata[a.currentPrArray][vcdata[a.currrentSlideNo]]&&vcdata[a.currentPrArray][vcdata[a.currrentSlideNo]].hide();a.prvPrArray;vcdata[prvSlideNo]=a.prvSlide;var b=shapes;whiteboardClicked=a.whiteboardClicked,shapes=a.shapes,wb_lArray=a.wb_lArray,wb_eArray=a.wb_eArray,wb_rArray=a.wb_rArray,wb_flArray=a.wb_flArray,wb_txtArray=a.wb_txtArray,currentPrArray=a.currentPrArray,currrentSlideNo=a.currrentSlideNo,uploadedImgArray=a.uploadedImgArray,storeMessages=a.storeMessages,vcdata[whiteboardClicked]||(vcdata[whiteboardClicked]=!1),vcdata[shapes]||(vcdata[shapes]=[]),vcdata[wb_lArray]||(vcdata[wb_lArray]=[]),vcdata[wb_eArray]||(vcdata[wb_eArray]=[]),vcdata[wb_rArray]||(vcdata[wb_rArray]=[]),vcdata[wb_flArray]||(vcdata[wb_flArray]=[]),vcdata[wb_txtArray]||(vcdata[wb_txtArray]=[]),vcdata[currentPrArray]||(vcdata[currentPrArray]=[]),vcdata[currrentSlideNo]||(vcdata[currrentSlideNo]=0),vcdata[uploadedImgArray]||(vcdata[uploadedImgArray]=[]),vcdata[storeMessages]||(vcdata[storeMessages]=!1),vcdata[whiteboardClicked]=!0,currentWbId=a.whiteboardID,null!==vcdata[restoreWbDataArr]&&0!==vcdata[restoreWbDataArr].length&&vcdata[shapesLoadedWb]===!1&&restoreShapesWb(vcdata[restoreWbDataArr],a.whiteboardID),null!==vcdata[restoreEraseDataArr]&&restoreEraseData(vcdata[restoreEraseDataArr],a.whiteboardID),"undefined"!=typeof vcdata[b]&&"undefined"!=typeof vcdata[shapes]&&(Array.prototype.map.call(vcdata[shapes],function(a){a.store;shapes!==b&&a.node.show()}),Array.prototype.map.call(vcdata[b],function(a){a.store;shapes!==b&&a.node.hide()})),vcdata[storeMessages]=!0,$("#wbl").attr("disabled","disabled"),$("#switch").removeAttr("disabled"),vcdata[a.storeMessages]=!0,showHideUploadedimgs(!0)}),socket.on("move_to_presentation",function(a){clearTimeout(timer6),clearTimeout(timer7),$("#switch").attr("disabled","disabled"),$("#wbl").removeAttr("disabled"),"undefined"!=typeof vcdata[currentPrArray][vcdata[currrentSlideNo]]&&vcdata[currentPrArray][vcdata[currrentSlideNo]].hide();var b=shapes;currrentSlideNo=a.currrentSlideNo,currentPrArray=a.currentPrArray,noOfSlides=a.noOfSlides,orgSlideCount=a.orgSlideCount,imageRequest=a.imageRequest,tmpSlide=a.tmpSlide,tmpSlideEnd=a.tmpSlideEnd,forceLoad=a.forceLoad,whiteboardClicked=a.whiteboardClicked,shapes=a.shapes,pr_fArray=a.pr_fArray,pr_lArray=a.pr_lArray,pr_eArray=a.pr_eArray,pr_rArray=a.pr_rArray,pr_flArray=a.pr_flArray,pr_txtArray=a.pr_txtArray,storeMessages=a.storeMessages,vcdata[currrentSlideNo]||(vcdata[currrentSlideNo]=0),vcdata[currentPrArray]||(vcdata[currentPrArray]=[]),vcdata[noOfSlides]||(vcdata[noOfSlides]=0),vcdata[orgSlideCount]||(vcdata[orgSlideCount]=0),vcdata[imageRequest]||(vcdata[imageRequest]=!1),vcdata[tmpSlide]||(vcdata[tmpSlide]=0),vcdata[tmpSlideEnd]||(vcdata[tmpSlideEnd]=0),vcdata[forceLoad]||(vcdata[forceLoad]=0),vcdata[whiteboardClicked]||(vcdata[whiteboardClicked]=!1),vcdata[shapes]||(vcdata[shapes]=[]),vcdata[pr_fArray]||(vcdata[pr_fArray]=[]),vcdata[pr_lArray]||(vcdata[pr_lArray]=[]),vcdata[pr_eArray]||(vcdata[pr_eArray]=[]),vcdata[pr_rArray]||(vcdata[pr_rArray]=[]),vcdata[pr_flArray]||(vcdata[pr_flArray]=[]),vcdata[pr_txtArray]||(vcdata[pr_txtArray]=[]),vcdata[storeMessages]||(vcdata[storeMessages]=!1),currentPrId=a.presentationID,vcdata[storeMessages]=!1;var c;c=shapes+"_"+a.currrentPrSlideNo,"undefined"!=typeof vcdata[b]&&"undefined"!=typeof vcdata[shapes]&&(Array.prototype.map.call(vcdata[shapes],function(a){a.store;shapes!==b&&(c===a.prShpID?a.node.show():a.node.hide())}),Array.prototype.map.call(vcdata[b],function(a){a.store;shapes!==b&&a.node.hide()})),null===vcdata[currentPrArray]||0===vcdata[currentPrArray].length?a.whiteboardClickedStatus===!1?loadImages():(loadImages(),vcdata[currentPrArray][0].hide()):(a.whiteboardClickedStatus===!1,vcdata[currentPrArray][vcdata[currrentSlideNo]].show()),null!==vcdata[restorePrDataArr]&&0!==vcdata[restorePrDataArr].length&&vcdata[shapesLoadedPr]===!1&&restoreShapesPr(vcdata[restorePrDataArr],a.presentationID,a.currrentPrSlideNo),showHideUploadedimgs(!1),updateOriginalSlideCount(vcdata[orgSlideCount]),updateSlideCount(vcdata[currrentSlideNo]+1)}),socket.on("updateslides",function(a){if(null!==a.pr_data&&(currentPrArray=a.pr_data.currentPrArray,currrentSlideNo=a.pr_data.currrentSlideNo,noOfSlides=a.pr_data.noOfSlides,orgSlideCount=a.pr_data.orgSlideCount,imageRequest=a.pr_data.imageRequest,tmpSlide=a.pr_data.tmpSlide,tmpSlideEnd=a.pr_data.tmpSlideEnd,forceLoad=a.pr_data.forceLoad,whiteboardClicked=a.pr_data.whiteboardClicked,prvSlide=a.pr_data.prvSlide,prvPrArray=a.pr_data.prvPrArray,currentPrId=a.pr_data.presentationID,uploadedImgArray=a.pr_data.uploadedImgArray,shapesLoadedWb=a.shapesLoadedWb,shapesLoadedPr=a.shapesLoadedPr,vcdata[currentPrArray]||(vcdata[currentPrArray]=[]),vcdata[currrentSlideNo]||(vcdata[currrentSlideNo]=0),vcdata[prvSlideNo]||(vcdata[prvSlideNo]=0),vcdata[noOfSlides]||(vcdata[noOfSlides]=0),vcdata[orgSlideCount]||(vcdata[orgSlideCount]=0),vcdata[imageRequest]||(vcdata[imageRequest]=!1),vcdata[tmpSlide]||(vcdata[tmpSlide]=0),vcdata[tmpSlideEnd]||(vcdata[tmpSlideEnd]=0),vcdata[forceLoad]||(vcdata[forceLoad]=0),vcdata[whiteboardClicked]||(vcdata[whiteboardClicked]=!1),vcdata[prvPrArray]||(vcdata[prvPrArray]=[]),vcdata[shapesLoadedWb]||(vcdata[shapesLoadedWb]=!1),vcdata[shapesLoadedPr]||(vcdata[shapesLoadedPr]=!1),vcdata[prvSlideNo]=prvSlide,"undefined"!=typeof a.pr_data.whiteboardID&&(currentWbId=a.pr_data.whiteboardID)),vcdata[whiteboardClicked]=a.wbl,null!==a.udata&&Array.prototype.map.call(a.udata,function(a){vcdata[a.uploadedImgArray]||(vcdata[a.uploadedImgArray]=[]),0===vcdata[a.uploadedImgArray].length&&vcdata[a.uploadedImgArray].push(null),imgUrl=uploads_dir+"uploaded_"+a.currentWbId+"_"+a.imgNo+".png",uimage=paper.image(imgUrl,0,0,a.width,a.height),vcdata[a.uploadedImgArray].push(uimage),uimage.hide(),uimage.draggable(),no=a.imgNo<10?"0"+a.imgNo:a.imgNo,uimage.node.id="uploaded_"+a.currentWbId+"_"+no}),showHideUploadedimgs(a.wbl),null===a.wbl&&(vcdata[whiteboardClicked]=noPresentation?!0:!1),a.wbl===!0?(disableSlideControls(!0),flag_wb=!0,flag_pr=!1,$("#wb1").addClass("whiteboard_active"),$(".b_wbl").addClass("active")):(disableSlideControls(!1),flag_wb=!1,flag_pr=!0),void 0!==vcdata[currentPrArray][0]&&vcdata[currentPrArray][0].hide(),clearTimeout(timer),a.next===vcdata[orgSlideCount]-1&&$("#lst").attr("disabled","disabled"),0===a.next&&$("#frst").attr("disabled","disabled"),a.next<vcdata[orgSlideCount]&&a.next>=0&&(vcdata[currrentSlideNo]=a.next,vcdata[clientReconnect]=!0,"undefined"!=typeof a.next&&"undefined"!=typeof a.prv)){to=vcdata[orgSlideCount],to2=-1;for(var b=vcdata[orgSlideCount]-1;b>vcdata[orgSlideCount]-5;b--)fetchImages(b,currentPrId),to=b,vcdata[tmpSlideEnd]=b;if(b=a.next,b<vcdata[orgSlideCount]-3&&b<vcdata[tmpSlideEnd]){for(var c=a.next;c<a.next+3;c++)fetchImages(c,currentPrId),b=c+1;!function e(){fetchImages(b,currentPrId),timer6=setTimeout(e,TIME_DELAY),b>=to-1&&(clearTimeout(timer6),vcdata[imageRequest]=!1),vcdata[noOfSlides]=b,b++,tmp_slide_std=b}()}if(vcdata[currentPrArray][a.next].show(),k=a.next-1,k<=a.next+3&&k>=0){for(var d=a.next-1;d>=a.next-3;d--)d>=0&&fetchImages(d,currentPrId),k=d-1;!function f(){k>=0?fetchImages(k,currentPrId):(k=0,clearTimeout(timer7)),timer7=setTimeout(f,TIME_DELAY),(to2+1>=k||tmp_slide_std>=k)&&(vcdata[imageRequest]=!1),k--,vcdata[tmpSlideEnd]=k}()}a.wbl===!0?vcdata[currentPrArray][a.next].hide():(vcdata[currentPrArray][0]&&vcdata[currentPrArray][0].hide(),vcdata[currentPrArray][a.next].show()),updateSlideCount(a.next+1)}void 0!==vcdata[currentPrArray][a.next]&&vcdata[currentPrArray][a.next].toBack(),updateOriginalSlideCount(vcdata[orgSlideCount])});var ddd=1;socket.on("coords",function(a){vcdata[a.coords.ox]||(vcdata[a.coords.ox]=[]),vcdata[a.coords.oy]||(vcdata[a.coords.oy]=[]),"undefined"==typeof vcdata[a.coords.uploadedImgArray][parseInt(a.coords.imgNo)]&&(vcdata[a.coords.uploadedImgArray][parseInt(a.coords.imgNo)]=vcdata[a.coords.uploadedImgArray][ddd],ddd++),vcdata[a.coords.uploadedImgArray][parseInt(a.coords.imgNo)].transform("t"+a.coords._ox+","+a.coords._oy),vcdata[a.coords.ox][a.coords.imgNo]=a.coords._ox,vcdata[a.coords.oy][a.coords.imgNo]=a.coords._oy}),socket.on("shapes_data",function(a){shapes=a.shapes,storeMessages=a.storeMessages,vcdata[storeMessages]=a.storeMessagesStatus,restoreWbDataArr="restore_data_arr_wb"+a.prID,vcdata[restoreWbDataArr]||(vcdata[restoreWbDataArr]=[]),null!==a&&(vcdata[restoreWbDataArr]=a.data,a.whiteboardClicked===!0&&restoreShapesWb(a.data,a.prID))}),socket.on("shapes_data_tmp",function(a){shapes=a.shapes,storeMessages=a.storeMessages,vcdata[storeMessages]=a.storeMessagesStatus,restorePrDataArr="restore_data_arr_pr"+a.prID,vcdata[restorePrDataArr]||(vcdata[restorePrDataArr]=[]),null!==a&&(vcdata[restorePrDataArr]=a.data,(a.whiteboardClicked===!1||null===a.whiteboardClicked)&&restoreShapesPr(a.data,a.prID,a.slideNo))}),socket.on("erase_data",function(a){null!==a&&(restoreEraseDataArr="restore_erase_data_wb"+a.prID,vcdata[restoreEraseDataArr]||(vcdata[restoreEraseDataArr]=[]),vcdata[restoreEraseDataArr]=a.data,a.whiteboardClicked===!0&&restoreEraseData(a.data,a.prID))}),socket.on("connect",function(){console.log("Client Connected")}),socket.on("error",function(a){console.error("unable to connect !",a)}),socket.on("freeline_path",function(a){fline=FreeLine(a._flb,a._fle,paper,a._colour,a._strokeWidth)}),socket.on("freeline_path_update",function(a){Array.prototype.map.call(a._arr,function(a){fline.updateEnd(a.flx,a.fly)})}),socket.on("line_path",function(a){line=Line(a._lb,a._le,a._lb,a._le,paper,a._colour,a._strokeWidth)}),socket.on("line_path_update",function(a){line.updateEnd(a._lx,a._ly)}),socket.on("ellipse_path",function(a){ellipse=Ellipse(a._cb,a._ce,0,0,paper,a._colour,a._strokeWidth)}),socket.on("ellipse_path_update",function(a){ellipse.updateEnd(a._cx,a._cy)}),socket.on("rect_path",function(a){rect=Rect(a._rb,a._re,5,5,paper,a._colour,a._strokeWidth)}),socket.on("rect_path_update",function(a){rect.updateEnd(a._rx,a._ry)}),socket.on("text_path",function(a){k=$("#wb1").offset().left,l=$("#wb1").offset().top,text=Text(a._txtx-k,a._txty-l,a._text,paper,a._colour)}),socket.on("clear_paper_now",function(a){a._clr===!0&&(remoteShowHideUploadedimgs(90001),emptyElementArraysWb(),a.wbclicked===!0&&(removeUploadedImages(),permenentlyDeleteShapes()),"undefined"!=vcdata[restoreWbDataArr]&&null!==vcdata[restoreWbDataArr]&&(a.wbclicked===!0&&(showHidePrDrawings(90001),vcdata[restoreWbDataArr].length=0),null!==vcdata[restorePrDataArr]&&(vcdata[restorePrDataArr].length=0)))}),socket.on("erase_line",function(a){erase_line=FreeLine(a._eflb,a._efle,paper,a._colour,a._strokeWidth),erase_line.toFront()}),socket.on("erase_line_update",function(a){Array.prototype.map.call(a._earr,function(a){erase_line.updateEnd(a.eflx,a.efly),erase_line.toFront()})}),socket.on("undo_drawing_now",function(a){if(a.wbclicked===!0){var b=getShapeCountWb(vcdata[shapes]);vcdata[shapes][b-1]&&(vcdata[shapes][b-1].node.hide(),vcdata[undoShpArr2].push(vcdata[shapes][b-1]),vcdata[shapes].splice(b-1,1))}else{sortShapes(vcdata[shapes]);var c=getInnerBound(vcdata[shapes],vcdata[currrentSlideNo]),d=getShapeCount(vcdata[shapes],vcdata[currrentSlideNo]);vcdata[shapes][d+c-1]&&(vcdata[shapes][d+c-1].node.hide(),vcdata[undoShpArr].push(vcdata[shapes][d+c-1]),vcdata[shapes].splice(d+c-1,1))}}),socket.on("redo_drawing_now",function(a){if(a.wbclicked===!0){var b=getShapeCountWb(vcdata[undoShpArr2]);vcdata[undoShpArr2]&&(vcdata[undoShpArr2][b-1].node.show(),vcdata[shapes].push(vcdata[undoShpArr2][b-1]),vcdata[undoShpArr2].splice(b-1,1))}else{{vcdata[undoShpArr].length}sortShapes(vcdata[undoShpArr]);var c=getInnerBound(vcdata[undoShpArr],vcdata[currrentSlideNo]),d=getShapeCount(vcdata[undoShpArr],vcdata[currrentSlideNo]);vcdata[undoShpArr][c]&&(vcdata[undoShpArr][d+c-1].node.show(),vcdata[shapes].push(vcdata[undoShpArr][d+c-1]),vcdata[undoShpArr].splice(d+c-1,1))}}),socket.on("goto_next_page",function(a){vcdata[currrentSlideNo]=a.next,vcdata[storeMessages]=!1,remoteShowHideUploadedimgs(1),vcdata[currentPrArray][0].hide(),a.next<vcdata[noOfSlides]&&a.next>=0?"undefined"!=typeof vcdata[currentPrArray][a.next]&&"undefined"!=typeof vcdata[currentPrArray][a.prv]?(vcdata[currentPrArray][a.prv].hide(),vcdata[currentPrArray][a.next].show(),updateSlideCount(a.next+1)):(clearTimeout(timer6),fetchImages(a.next,currentPrId),vcdata[currentPrArray][a.prv].hide(),vcdata[currentPrArray][a.next].show()):vcdata[noOfSlides]<=vcdata[orgSlideCount]?(vcdata[imageRequest]===!0&&(clearTimeout(timer6),fetchImages(a.next,currentPrId)),"undefined"!=typeof vcdata[currentPrArray][a.next]&&"undefined"!=typeof vcdata[currentPrArray][a.prv]?(vcdata[currentPrArray][a.prv].hide(),vcdata[currentPrArray][a.next].show(),updateSlideCount(a.next+1)):(clearTimeout(timer6),fetchImages(a.next,currentPrId),vcdata[currentPrArray][a.prv].hide(),vcdata[currentPrArray][a.next].show()),vcdata[noOfSlides]++):("undefined"!=typeof vcdata[currentPrArray][a.next]&&"undefined"!=typeof vcdata[currentPrArray][a.prv]?(vcdata[currentPrArray][a.prv].hide(),vcdata[currentPrArray][a.next].show(),updateSlideCount(a.next+1)):requestImageRange(a.next),vcdata[imageRequest]=!1)}),socket.on("goto_prv_page",function(a){vcdata[currrentSlideNo]=student_access===!0?a.next:a.next,vcdata[storeMessages]=!1,remoteShowHideUploadedimgs(-1),a.prv>0&&("undefined"!=typeof vcdata[currentPrArray][a.next]&&"undefined"!=typeof vcdata[currentPrArray][a.prv]?(vcdata[currentPrArray][a.next].show(),vcdata[currentPrArray][a.prv].hide(),updateSlideCount(a.next+1)):(clearTimeout(timer4),fetchImages(a.next,currentPrId),vcdata[currentPrArray][a.next].show(),vcdata[currentPrArray][a.prv].hide()))}),socket.on("goto_frst_page",function(a){vcdata[currrentSlideNo]=student_access===!0?a.next:a.next,vcdata[storeMessages]=!1,clearTimeout(timer7),remoteShowHideUploadedimgs(10001),studInLastSlide===!0&&(clearTimeout(timer4),loadFrontImages(tmp_slide_std,vcdata[tmpSlideEnd]),vcdata[noOfSlides]=vcdata[orgSlideCount],tmp_slide_std=vcdata[orgSlideCount]-1,vcdata[tmpSlideEnd]=vcdata[orgSlideCount]-1),a.prv>0&&(vcdata[currentPrArray][a.prv].hide(),vcdata[currentPrArray][a.next].show(),updateSlideCount(a.next+1))}),socket.on("goto_lst_page",function(a){vcdata[currrentSlideNo]=student_access===!0?a.next:a.next,vcdata[storeMessages]=!1,clearTimeout(timer6),remoteShowHideUploadedimgs(50001),studInLastSlide===!1?(studInLastSlide=!0,tmp_slide_std=vcdata[noOfSlides]):studInLastSlide=!1,vcdata[imageRequest]===!0&&("undefined"!=typeof vcdata[tmpSlideEnd]?(requestOtherImages(vcdata[noOfSlides],vcdata[tmpSlideEnd]-1),vcdata[imageRequest]=!1):(requestOtherImages(vcdata[noOfSlides],a.next),vcdata[imageRequest]=!1)),updateSlideCount(a.next+1),vcdata[currentPrArray][a.next]||fetchImages(a.next,currentPrId),vcdata[currentPrArray][a.prv]||fetchImages(a.prv,currentPrId),vcdata[currentPrArray][a.prv].hide(),vcdata[currentPrArray][a.next].show()}),socket.on("access_to_slide_controls",function(a){student_access=a===!0?!0:!1});var accessToWhiteboard=!1;socket.on("hand_raised",function(a){accessToWhiteboard="eee458fc0e164cb5af7978eb5c5af0c1"===a.token?!0:!1}),socket.on("whiteboard_access_granted",function(a){});